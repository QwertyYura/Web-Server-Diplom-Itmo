package ru.lb.impl.server.ssl;

import org.junit.jupiter.api.Test;
import ru.lb.design.server.ssl.ExtensionType;
import ru.lb.impl.server.ssl.Extensions.ApplicationLayerProtocolNegotiation;

import java.nio.ByteBuffer;

import static org.junit.jupiter.api.Assertions.*;

class SSLTest {

    @Test
    void HelloClientToByte() {
        byte[] arr = SSLUtils.hexStringToByteArray("16030102190100021503038021628dbe3614db33dffd6c046521bb4848936ddc44049655d0b468e9ca8ee820b958e82415b1455a3a81a6310500e309119d535a117fb13d91297cfcc1ddb4b60022baba130113021303c02bc02fc02cc030cca9cca8c013c014009c009d002f0035000a010001aa8a8a00000000001a00180000156170692e62726f777365722e79616e6465782e727500170000ff01000100000a000a00083a3a001d00170018000b00020100002300e03751db176914296a7e34d382ef1b975899ca5c53d55c5a0e917a282e3a8ba08722a1dda64696da75c5b7654425d698ce01883758fc67a6bbc56ea2be2f77a737091c20b80ddb881c8468343e457e2bf9685da8d38d13569fecb921efe1abbdc4c1164888e8d9c6df13294151dd6f3fad2ba56311f0c506252a228cd2838fc6a58906fbbdb303f1af5dec1de23de76c14008f0f25eddf72a11c851c5e575ae47a5aca05b8caf4e2aba46c912727f42b04758c466288c52a965e7c61be254f032cb3ae2b7878a04e54b0d0c70848507a27a87e91c9289254fd176d0982894dd45b0010000e000c02683208687474702f312e31000500050100000000000d00140012040308040401050308050501080606010201001200000033002b00293a3a000100001d0020c182c23ddf06c5ac9a3e85010195026f43d7c0e26756eb90d60e527b3386c269002d00020101002b000b0a3a3a0304030303020301001b0003020002dada000100");
        ByteBuffer buf = ByteBuffer.allocate(arr.length);
        buf.put(arr);

        SSL ssl = new SSL();
        ssl.setSSL(buf);

        assertArrayEquals(arr, ssl.toByte());
    }
}